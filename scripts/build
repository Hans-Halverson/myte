#!/bin/bash

set -e

CURRENT_DIR=$(cd "$(dirname "$0")" && pwd)
ROOT_DIR=$(dirname "$CURRENT_DIR")

# Build myte executable
cd "$ROOT_DIR/src"
opam exec -- dune build myte.exe --no-print-directory "$@"

# Build test suite
cd "$ROOT_DIR/test"
opam exec -- dune build run_tests.exe --no-print-directory

# Build runtime
"$CURRENT_DIR/build_runtime"